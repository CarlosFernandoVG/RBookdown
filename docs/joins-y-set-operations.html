<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.7 Joins y Set Operations | Programación en R</title>
  <meta name="description" content="Material para el aprendizaje de R como lenguaje de programación para los cursos de Estadística en la Facultado de Ciencias, Universidad Nacional Autónoma de México" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="6.7 Joins y Set Operations | Programación en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/CarlosFernandoVG/RBookdown" />
  
  <meta property="og:description" content="Material para el aprendizaje de R como lenguaje de programación para los cursos de Estadística en la Facultado de Ciencias, Universidad Nacional Autónoma de México" />
  <meta name="github-repo" content="CarlosFernandoVG/RBookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.7 Joins y Set Operations | Programación en R" />
  
  <meta name="twitter:description" content="Material para el aprendizaje de R como lenguaje de programación para los cursos de Estadística en la Facultado de Ciencias, Universidad Nacional Autónoma de México" />
  

<meta name="author" content="Sofía Villers Gómez" />
<meta name="author" content="Carlos Fernando Vásquez Guerra" />
<meta name="author" content="David Alberto Mateos Montes de Oca" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyrrename.html"/>
<link rel="next" href="graficación-de-datos-ggplot.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Programación en R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objetivos"><i class="fa fa-check"></i>Objetivos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura"><i class="fa fa-check"></i>Estructura</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#detalles-técnicos"><i class="fa fa-check"></i>Detalles técnicos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licencia"><i class="fa fa-check"></i>Licencia</a></li>
</ul></li>
<li class="part"><span><b>I Todo empieza con R</b></span></li>
<li class="chapter" data-level="1" data-path="introducción-e-instalación.html"><a href="introducción-e-instalación.html"><i class="fa fa-check"></i><b>1</b> Introducción e instalación</a>
<ul>
<li class="chapter" data-level="" data-path="introducción-e-instalación.html"><a href="introducción-e-instalación.html#r-y-rstudio"><i class="fa fa-check"></i>R y RStudio</a></li>
<li class="chapter" data-level="" data-path="introducción-e-instalación.html"><a href="introducción-e-instalación.html#recursos-adicionales"><i class="fa fa-check"></i>Recursos adicionales</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>2</b> Markdown</a></li>
<li class="chapter" data-level="3" data-path="conocimientos-básicos-de-r.html"><a href="conocimientos-básicos-de-r.html"><i class="fa fa-check"></i><b>3</b> Conocimientos básicos de R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="buscando-ayuda.html"><a href="buscando-ayuda.html"><i class="fa fa-check"></i><b>3.1</b> Buscando ayuda</a></li>
<li class="chapter" data-level="3.2" data-path="vectores-y-operaciones.html"><a href="vectores-y-operaciones.html"><i class="fa fa-check"></i><b>3.2</b> Vectores y operaciones</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="vectores-y-operaciones.html"><a href="vectores-y-operaciones.html#vectores-atómicos"><i class="fa fa-check"></i><b>3.2.1</b> Vectores atómicos</a></li>
<li class="chapter" data-level="3.2.2" data-path="vectores-y-operaciones.html"><a href="vectores-y-operaciones.html#otros-tipos-de-datos"><i class="fa fa-check"></i><b>3.2.2</b> Otros tipos de datos</a></li>
<li class="chapter" data-level="3.2.3" data-path="vectores-y-operaciones.html"><a href="vectores-y-operaciones.html#asignación-de-nombres-y-atributos"><i class="fa fa-check"></i><b>3.2.3</b> Asignación de nombres y atributos</a></li>
<li class="chapter" data-level="3.2.4" data-path="vectores-y-operaciones.html"><a href="vectores-y-operaciones.html#operaciones-básicas-en-r"><i class="fa fa-check"></i><b>3.2.4</b> Operaciones básicas en R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html"><i class="fa fa-check"></i><b>3.3</b> Estructuras de datos</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#vectores"><i class="fa fa-check"></i><b>3.3.1</b> Vectores</a></li>
<li class="chapter" data-level="3.3.2" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#listas"><i class="fa fa-check"></i><b>3.3.2</b> Listas</a></li>
<li class="chapter" data-level="3.3.3" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#arreglos"><i class="fa fa-check"></i><b>3.3.3</b> Arreglos</a></li>
<li class="chapter" data-level="3.3.4" data-path="estructuras-de-datos.html"><a href="estructuras-de-datos.html#data-frames"><i class="fa fa-check"></i><b>3.3.4</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sentencias-de-control-ciclos-y-funciones.html"><a href="sentencias-de-control-ciclos-y-funciones.html"><i class="fa fa-check"></i><b>3.4</b> Sentencias de control, ciclos y funciones</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sentencias-de-control-ciclos-y-funciones.html"><a href="sentencias-de-control-ciclos-y-funciones.html#if-if-else"><i class="fa fa-check"></i><b>3.4.1</b> If &amp; If-else</a></li>
<li class="chapter" data-level="3.4.2" data-path="sentencias-de-control-ciclos-y-funciones.html"><a href="sentencias-de-control-ciclos-y-funciones.html#for-while-y-repeat"><i class="fa fa-check"></i><b>3.4.2</b> For, While y Repeat</a></li>
<li class="chapter" data-level="3.4.3" data-path="sentencias-de-control-ciclos-y-funciones.html"><a href="sentencias-de-control-ciclos-y-funciones.html#funciones"><i class="fa fa-check"></i><b>3.4.3</b> Funciones</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="funciones-1.html"><a href="funciones-1.html"><i class="fa fa-check"></i><b>3.5</b> Funciones</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="funciones-1.html"><a href="funciones-1.html#funciones-2"><i class="fa fa-check"></i><b>3.5.1</b> Funciones</a></li>
<li class="chapter" data-level="3.5.2" data-path="funciones-1.html"><a href="funciones-1.html#vectorización"><i class="fa fa-check"></i><b>3.5.2</b> Vectorización</a></li>
<li class="chapter" data-level="3.5.3" data-path="funciones-1.html"><a href="funciones-1.html#paquetes"><i class="fa fa-check"></i><b>3.5.3</b> Paquetes</a></li>
<li class="chapter" data-level="3.5.4" data-path="funciones-1.html"><a href="funciones-1.html#miscellaneous"><i class="fa fa-check"></i><b>3.5.4</b> Miscellaneous</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="iteración-y-recursión.html"><a href="iteración-y-recursión.html"><i class="fa fa-check"></i><b>3.6</b> Iteración y Recursión</a></li>
<li class="chapter" data-level="3.7" data-path="graficación.html"><a href="graficación.html"><i class="fa fa-check"></i><b>3.7</b> Graficación</a></li>
</ul></li>
<li class="part"><span><b>II EfficientR</b></span></li>
<li class="chapter" data-level="4" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4</b> Tidyverse</a></li>
<li class="chapter" data-level="5" data-path="limpieza-de-datos-tidyr.html"><a href="limpieza-de-datos-tidyr.html"><i class="fa fa-check"></i><b>5</b> Limpieza de datos: Tidyr</a></li>
<li class="chapter" data-level="6" data-path="manipulación-de-datos-dplyr.html"><a href="manipulación-de-datos-dplyr.html"><i class="fa fa-check"></i><b>6</b> Manipulación de datos: Dplyr</a>
<ul>
<li class="chapter" data-level="6.1" data-path="dplyrfilter.html"><a href="dplyrfilter.html"><i class="fa fa-check"></i><b>6.1</b> dplyr::filter()</a></li>
<li class="chapter" data-level="6.2" data-path="dplyrselect.html"><a href="dplyrselect.html"><i class="fa fa-check"></i><b>6.2</b> dplyr::select()</a></li>
<li class="chapter" data-level="6.3" data-path="dplyrarrange.html"><a href="dplyrarrange.html"><i class="fa fa-check"></i><b>6.3</b> dplyr::arrange()</a></li>
<li class="chapter" data-level="6.4" data-path="dplyrmutate.html"><a href="dplyrmutate.html"><i class="fa fa-check"></i><b>6.4</b> dplyr::mutate()</a></li>
<li class="chapter" data-level="6.5" data-path="dplyrgroup-by.html"><a href="dplyrgroup-by.html"><i class="fa fa-check"></i><b>6.5</b> dplyr::group_by()</a></li>
<li class="chapter" data-level="6.6" data-path="dplyrrename.html"><a href="dplyrrename.html"><i class="fa fa-check"></i><b>6.6</b> dplyr::rename</a></li>
<li class="chapter" data-level="6.7" data-path="joins-y-set-operations.html"><a href="joins-y-set-operations.html"><i class="fa fa-check"></i><b>6.7</b> Joins y Set Operations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graficación-de-datos-ggplot.html"><a href="graficación-de-datos-ggplot.html"><i class="fa fa-check"></i><b>7</b> Graficación de datos: Ggplot</a></li>
<li class="part"><span><b>III Presentando datos</b></span></li>
<li class="chapter" data-level="8" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>8</b> Introducción</a></li>
<li class="chapter" data-level="9" data-path="manejo-de-números.html"><a href="manejo-de-números.html"><i class="fa fa-check"></i><b>9</b> Manejo de números</a></li>
<li class="chapter" data-level="10" data-path="tablas.html"><a href="tablas.html"><i class="fa fa-check"></i><b>10</b> Tablas</a>
<ul>
<li class="chapter" data-level="10.1" data-path="tabla-de-resumen.html"><a href="tabla-de-resumen.html"><i class="fa fa-check"></i><b>10.1</b> Tabla de resumen</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="gráficos.html"><a href="gráficos.html"><i class="fa fa-check"></i><b>11</b> Gráficos</a>
<ul>
<li class="chapter" data-level="11.1" data-path="gráfico-circular.html"><a href="gráfico-circular.html"><i class="fa fa-check"></i><b>11.1</b> Gráfico circular</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Hecho con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Programación en R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="joins-y-set-operations" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Joins y Set Operations</h2>
<p>Anteriormente ya se había mencionado la unión entre matrices, por renglón o columna y de la función <code>base::merge()</code>, las cuales tienen su optimización por parte de dplyr.</p>
<p>Por parte de las funciones que unen registros o variables, se tienen las funciones <code>dplyr::bind_rows()</code> y <code>bind_cols()</code>. Las mismas reglas que <code>cbind()</code> y <code>rbind()</code> se deben respetar.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="joins-y-set-operations.html#cb372-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb372-2"><a href="joins-y-set-operations.html#cb372-2" aria-hidden="true"></a>x &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">One_Two =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> T), </span>
<span id="cb372-3"><a href="joins-y-set-operations.html#cb372-3" aria-hidden="true"></a>            <span class="dt">Three_Four=</span> <span class="kw">sample</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> T), </span>
<span id="cb372-4"><a href="joins-y-set-operations.html#cb372-4" aria-hidden="true"></a>            <span class="dt">Five_Six =</span> <span class="kw">sample</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> T))</span>
<span id="cb372-5"><a href="joins-y-set-operations.html#cb372-5" aria-hidden="true"></a>y &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">One_Two =</span> <span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">Three_Four =</span> <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">3</span>), <span class="dt">Five_Six =</span> <span class="kw">rep</span>(<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb372-6"><a href="joins-y-set-operations.html#cb372-6" aria-hidden="true"></a><span class="kw">bind_rows</span>(x,y)</span></code></pre></div>
<pre><code># A tibble: 8 x 3
  One_Two Three_Four Five_Six
    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1       2          3        5
2       1          4        5
3       1          3        5
4       2          4        5
5       2          4        5
6       2          4        5
7       2          4        5
8       2          4        5</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="joins-y-set-operations.html#cb374-1" aria-hidden="true"></a>z &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">One_Eigth =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb374-2"><a href="joins-y-set-operations.html#cb374-2" aria-hidden="true"></a><span class="kw">bind_cols</span>(<span class="kw">bind_rows</span>(x,y), z)</span></code></pre></div>
<pre><code># A tibble: 8 x 4
  One_Two Three_Four Five_Six One_Eigth
    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;int&gt;
1       2          3        5         1
2       1          4        5         2
3       1          3        5         3
4       2          4        5         4
5       2          4        5         5
6       2          4        5         6
7       2          4        5         7
8       2          4        5         8</code></pre>
<p>Respecto a las operaciones de conjuntos se tienen las funciones <code>dplyr::interset()</code>, <code>dplyr::union</code> y <code>dplyr::setdiff()</code>.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="joins-y-set-operations.html#cb376-1" aria-hidden="true"></a><span class="kw">intersect</span>(x, y)</span></code></pre></div>
<pre><code># A tibble: 1 x 3
  One_Two Three_Four Five_Six
    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1       2          4        5</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="joins-y-set-operations.html#cb378-1" aria-hidden="true"></a><span class="kw">union</span>(x, y)</span></code></pre></div>
<pre><code># A tibble: 4 x 3
  One_Two Three_Four Five_Six
    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1       2          3        5
2       1          4        5
3       1          3        5
4       2          4        5</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="joins-y-set-operations.html#cb380-1" aria-hidden="true"></a><span class="kw">setdiff</span>(x, y)</span></code></pre></div>
<pre><code># A tibble: 3 x 3
  One_Two Three_Four Five_Six
    &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
1       2          3        5
2       1          4        5
3       1          3        5</code></pre>
<p>Las operaciones tipo <a href="https://es.wikipedia.org/wiki/Join">Join</a> son muy importantes en la extracción de información en bases de datos, <code>dplyr</code> por su cuenta tiene varias funciones para trabajar.</p>
<ul>
<li><code>dplyr::left_join(a, b, by = x)</code>: Une las bases de datos de acuerdo a la variable x tomando la preferencia sobre a.</li>
<li><code>dplyr::rigth_join(a, b, by = x)</code>: Une las bases de datos de acuerdo a la variable x tomando la preferencia sobre b.</li>
<li><code>dplyr::inner_join(a, b, by = x)</code>: Une las bases de datos de acuerdo a la variable x considerando a y b.</li>
<li><code>dplyr::full_join(a, b, by = x)</code>: Une las bases de datos de acuerdo a la variable x sin ninguna preferencia, por lo que contiene todos los datos posibles.</li>
</ul>
<p>Para ver más claro esto, véase los siguientes ejemplos.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="joins-y-set-operations.html#cb382-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb382-2"><a href="joins-y-set-operations.html#cb382-2" aria-hidden="true"></a>a &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">L =</span> <span class="kw">sample</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> T), </span>
<span id="cb382-3"><a href="joins-y-set-operations.html#cb382-3" aria-hidden="true"></a>            <span class="dt">N =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> T))</span>
<span id="cb382-4"><a href="joins-y-set-operations.html#cb382-4" aria-hidden="true"></a>b &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">L =</span> <span class="kw">sample</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> T), </span>
<span id="cb382-5"><a href="joins-y-set-operations.html#cb382-5" aria-hidden="true"></a>            <span class="dt">Lo =</span> <span class="kw">sample</span>(<span class="kw">c</span>(T, F), <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">replace =</span> T))</span>
<span id="cb382-6"><a href="joins-y-set-operations.html#cb382-6" aria-hidden="true"></a>a</span></code></pre></div>
<pre><code># A tibble: 5 x 2
  L         N
  &lt;chr&gt; &lt;int&gt;
1 C        94
2 B        62
3 A        45
4 B        41
5 E        67</code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="joins-y-set-operations.html#cb384-1" aria-hidden="true"></a>b</span></code></pre></div>
<pre><code># A tibble: 5 x 2
  L     Lo   
  &lt;chr&gt; &lt;lgl&gt;
1 E     TRUE 
2 A     TRUE 
3 E     TRUE 
4 B     TRUE 
5 D     FALSE</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="joins-y-set-operations.html#cb386-1" aria-hidden="true"></a><span class="kw">left_join</span>(a, b, <span class="dt">by =</span> <span class="st">&quot;L&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  L         N Lo   
  &lt;chr&gt; &lt;int&gt; &lt;lgl&gt;
1 C        94 NA   
2 B        62 TRUE 
3 A        45 TRUE 
4 B        41 TRUE 
5 E        67 TRUE 
6 E        67 TRUE </code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="joins-y-set-operations.html#cb388-1" aria-hidden="true"></a><span class="kw">right_join</span>(a, b, <span class="dt">by =</span> <span class="st">&quot;L&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  L         N Lo   
  &lt;chr&gt; &lt;int&gt; &lt;lgl&gt;
1 B        62 TRUE 
2 A        45 TRUE 
3 B        41 TRUE 
4 E        67 TRUE 
5 E        67 TRUE 
6 D        NA FALSE</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="joins-y-set-operations.html#cb390-1" aria-hidden="true"></a><span class="kw">inner_join</span>(a, b, <span class="dt">by =</span> <span class="st">&quot;L&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 5 x 3
  L         N Lo   
  &lt;chr&gt; &lt;int&gt; &lt;lgl&gt;
1 B        62 TRUE 
2 A        45 TRUE 
3 B        41 TRUE 
4 E        67 TRUE 
5 E        67 TRUE </code></pre>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="joins-y-set-operations.html#cb392-1" aria-hidden="true"></a><span class="kw">full_join</span>(a, b, <span class="dt">by =</span> <span class="st">&quot;L&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 7 x 3
  L         N Lo   
  &lt;chr&gt; &lt;int&gt; &lt;lgl&gt;
1 C        94 NA   
2 B        62 TRUE 
3 A        45 TRUE 
4 B        41 TRUE 
5 E        67 TRUE 
6 E        67 TRUE 
7 D        NA FALSE</code></pre>
<p>Y un ejemplo práctico: Tomando la base de datos de la población mexicana, se puede obtener los datos para los hombres y mujeres y modificarlos para que tengan un estructura similar a <code>Population_FEntity</code>.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="joins-y-set-operations.html#cb394-1" aria-hidden="true"></a>normalization &lt;-<span class="st"> </span><span class="cf">function</span>(data){</span>
<span id="cb394-2"><a href="joins-y-set-operations.html#cb394-2" aria-hidden="true"></a>  <span class="kw">colnames</span>(data) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Entidad Federativa&quot;</span>, <span class="st">&quot;Población Total&quot;</span>, <span class="kw">unique</span>(Population_FEntity<span class="op">$</span>Rango_edad))</span>
<span id="cb394-3"><a href="joins-y-set-operations.html#cb394-3" aria-hidden="true"></a>  data &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb394-4"><a href="joins-y-set-operations.html#cb394-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;Rango_edad&quot;</span>, </span>
<span id="cb394-5"><a href="joins-y-set-operations.html#cb394-5" aria-hidden="true"></a>           <span class="dt">value =</span> <span class="st">&quot;Porcentaje&quot;</span>, <span class="op">-</span><span class="kw">c</span>(<span class="st">&quot;Entidad Federativa&quot;</span>, <span class="st">&quot;Población Total&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb394-6"><a href="joins-y-set-operations.html#cb394-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Porcentaje =</span> Porcentaje<span class="op">/</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb394-7"><a href="joins-y-set-operations.html#cb394-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">&quot;Población&quot;</span> =<span class="st"> </span>Porcentaje <span class="op">*</span><span class="st"> `</span><span class="dt">Población Total</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb394-8"><a href="joins-y-set-operations.html#cb394-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Porcentaje, <span class="op">-</span><span class="st">`</span><span class="dt">Población Total</span><span class="st">`</span>)</span>
<span id="cb394-9"><a href="joins-y-set-operations.html#cb394-9" aria-hidden="true"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="joins-y-set-operations.html#cb395-1" aria-hidden="true"></a>Population_FEntity_M &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_xls</span>(<span class="st">&quot;Data/Population_Sex_FEntity.xls&quot;</span>, <span class="dt">range =</span> <span class="st">&quot;B43:Q74&quot;</span>, <span class="dt">col_names =</span> F)</span>
<span id="cb395-2"><a href="joins-y-set-operations.html#cb395-2" aria-hidden="true"></a>(Population_FEntity_M &lt;-<span class="st"> </span><span class="kw">normalization</span>(Population_FEntity_M))</span></code></pre></div>
<pre class="scroll-300"><code># A tibble: 448 x 3
   `Entidad Federativa` Rango_edad Población
   &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;
 1 Aguascalientes       0 a 4         51587.
 2 Baja California      0 a 4        124995.
 3 Baja California Sur  0 a 4         22289.
 4 Campeche             0 a 4         37749.
 5 Coahuila             0 a 4        104304.
 6 Colima               0 a 4         34496.
 7 Chiapas              0 a 4        170085.
 8 Chihuahua            0 a 4        122434.
 9 Distrito Federal     0 a 4        462096.
10 Durango              0 a 4         76977.
# … with 438 more rows</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="joins-y-set-operations.html#cb397-1" aria-hidden="true"></a>Population_FEntity_F &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_xls</span>(<span class="st">&quot;Data/Population_Sex_FEntity.xls&quot;</span>, <span class="dt">range =</span> <span class="st">&quot;B79:Q110&quot;</span>, <span class="dt">col_names =</span> F)</span>
<span id="cb397-2"><a href="joins-y-set-operations.html#cb397-2" aria-hidden="true"></a>(Population_FEntity_F &lt;-<span class="st"> </span><span class="kw">normalization</span>(Population_FEntity_F))</span></code></pre></div>
<pre class="scroll-300"><code># A tibble: 448 x 3
   `Entidad Federativa` Rango_edad Población
   &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;
 1 Aguascalientes       0 a 4         56336 
 2 Baja California      0 a 4        127107.
 3 Baja California Sur  0 a 4         22569 
 4 Campeche             0 a 4         32170 
 5 Coahuila             0 a 4        115765 
 6 Colima               0 a 4         23751.
 7 Chiapas              0 a 4        227851 
 8 Chihuahua            0 a 4        122055 
 9 Distrito Federal     0 a 4        366480 
10 Durango              0 a 4         68470 
# … with 438 more rows</code></pre>
<p>Así es fácil crear un sólo conjunto de datos donde se reúna toda la información relevante</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="joins-y-set-operations.html#cb399-1" aria-hidden="true"></a>Population_FEntity &lt;-<span class="st"> </span>Population_FEntity <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span><span class="st">`</span><span class="dt">Población Total</span><span class="st">`</span>)</span>
<span id="cb399-2"><a href="joins-y-set-operations.html#cb399-2" aria-hidden="true"></a>Population_FEntityWS &lt;-<span class="st"> </span><span class="kw">left_join</span>(Population_FEntity, Population_FEntity_M, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Entidad Federativa&quot;</span>, <span class="st">&quot;Rango_edad&quot;</span>))</span>
<span id="cb399-3"><a href="joins-y-set-operations.html#cb399-3" aria-hidden="true"></a>(Population_FEntityWS &lt;-<span class="st"> </span><span class="kw">left_join</span>(Population_FEntityWS, Population_FEntity_F, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Entidad Federativa&quot;</span>, <span class="st">&quot;Rango_edad&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb399-4"><a href="joins-y-set-operations.html#cb399-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">rename</span>( <span class="st">&quot;Población Total&quot;</span> =<span class="st"> &quot;Población.x&quot;</span>, <span class="st">&quot;PoblaciónM&quot;</span> =<span class="st"> &quot;Población.y&quot;</span>, <span class="st">&quot;PoblaciónF&quot;</span> =<span class="st"> &quot;Población&quot;</span>))</span></code></pre></div>
<pre class="scroll-300"><code># A tibble: 448 x 5
   `Entidad Federativa` Rango_edad `Población Total` PoblaciónM PoblaciónF
   &lt;chr&gt;                &lt;chr&gt;                  &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1 Aguascalientes       0 a 4                109853      51587.     56336 
 2 Baja California      0 a 4                268842     124995.    127107.
 3 Baja California Sur  0 a 4                 46070      22289.     22569 
 4 Campeche             0 a 4                 63034.     37749.     32170 
 5 Coahuila             0 a 4                244624.    104304.    115765 
 6 Colima               0 a 4                 45985      34496.     23751.
 7 Chiapas              0 a 4                491525     170085.    227851 
 8 Chihuahua            0 a 4                253834.    122434.    122055 
 9 Distrito Federal     0 a 4                682914.    462096.    366480 
10 Durango              0 a 4                150485      76977.     68470 
# … with 438 more rows</code></pre>
<ul>
<li>Por rango de edad ¿Qué sexo predomina en cada población?</li>
</ul>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="joins-y-set-operations.html#cb401-1" aria-hidden="true"></a>Population_FEntityWS <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb401-2"><a href="joins-y-set-operations.html#cb401-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PPredominante =</span> <span class="kw">if_else</span>(PoblaciónM<span class="op">&gt;=</span>PoblaciónF, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb401-3"><a href="joins-y-set-operations.html#cb401-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Entidad Federativa</span><span class="st">`</span>, Rango_edad, PPredominante)</span></code></pre></div>
<pre class="scroll-300"><code># A tibble: 448 x 3
   `Entidad Federativa` Rango_edad PPredominante
   &lt;chr&gt;                &lt;chr&gt;      &lt;chr&gt;        
 1 Aguascalientes       0 a 4      F            
 2 Baja California      0 a 4      F            
 3 Baja California Sur  0 a 4      F            
 4 Campeche             0 a 4      M            
 5 Coahuila             0 a 4      F            
 6 Colima               0 a 4      M            
 7 Chiapas              0 a 4      F            
 8 Chihuahua            0 a 4      M            
 9 Distrito Federal     0 a 4      M            
10 Durango              0 a 4      M            
# … with 438 more rows</code></pre>
<ul>
<li>Por rango de edad ¿Qué sexo predomina y en que estado se encuentra dicho resultado?</li>
</ul>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="joins-y-set-operations.html#cb403-1" aria-hidden="true"></a>Population_FEntityWS <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb403-2"><a href="joins-y-set-operations.html#cb403-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SPredominante =</span> <span class="kw">if_else</span>(PoblaciónM<span class="op">&gt;=</span>PoblaciónF, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb403-3"><a href="joins-y-set-operations.html#cb403-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">S =</span> <span class="kw">if_else</span>(SPredominante <span class="op">==</span><span class="st"> &quot;M&quot;</span>, PoblaciónM, PoblaciónF)) <span class="op">%&gt;%</span></span>
<span id="cb403-4"><a href="joins-y-set-operations.html#cb403-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(Rango_edad) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb403-5"><a href="joins-y-set-operations.html#cb403-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">1</span>, S) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Entidad Federativa</span><span class="st">`</span>, Rango_edad, SPredominante)</span></code></pre></div>
<pre><code># A tibble: 14 x 3
# Groups:   Rango_edad [14]
   `Entidad Federativa` Rango_edad SPredominante
   &lt;chr&gt;                &lt;chr&gt;      &lt;chr&gt;        
 1 México               0 a 4      M            
 2 México               5 a 9      M            
 3 México               10 a 14    M            
 4 México               15 a 19    F            
 5 México               20 a 24    F            
 6 México               25 a 29    F            
 7 México               30 a 34    F            
 8 México               35 a 39    F            
 9 México               40 a 44    F            
10 México               45 a 49    F            
11 México               50 a 54    F            
12 México               55 a 59    F            
13 Distrito Federal     60 y más   F            
14 México               NE         M            </code></pre>
<ul>
<li>¿Cuál estado tiene el mayor número de mujeres y cuál el de hombres?</li>
</ul>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="joins-y-set-operations.html#cb405-1" aria-hidden="true"></a>Population_by_sex_Mexico &lt;-<span class="st"> </span>Population_FEntityWS <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">Entidad Federativa</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb405-2"><a href="joins-y-set-operations.html#cb405-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">SMasculino =</span> <span class="kw">sum</span>(PoblaciónM), </span>
<span id="cb405-3"><a href="joins-y-set-operations.html#cb405-3" aria-hidden="true"></a>            <span class="dt">SFemenino =</span> <span class="kw">sum</span>(PoblaciónF))</span>
<span id="cb405-4"><a href="joins-y-set-operations.html#cb405-4" aria-hidden="true"></a><span class="kw">full_join</span>(</span>
<span id="cb405-5"><a href="joins-y-set-operations.html#cb405-5" aria-hidden="true"></a>  Population_by_sex_Mexico <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(SMasculino)) <span class="op">%&gt;%</span></span>
<span id="cb405-6"><a href="joins-y-set-operations.html#cb405-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>SFemenino),</span>
<span id="cb405-7"><a href="joins-y-set-operations.html#cb405-7" aria-hidden="true"></a>  Population_by_sex_Mexico <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(SFemenino)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb405-8"><a href="joins-y-set-operations.html#cb405-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>SMasculino), </span>
<span id="cb405-9"><a href="joins-y-set-operations.html#cb405-9" aria-hidden="true"></a>  <span class="dt">by =</span> <span class="st">&quot;Entidad Federativa&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 3
  `Entidad Federativa` SMasculino SFemenino
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;
1 México                 6871269.   7305419</code></pre>
<p>¿Cuál es el rango de edad con mayor población en mujeres y hombres?</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="joins-y-set-operations.html#cb407-1" aria-hidden="true"></a>Population_by_sex_age_Mexico &lt;-<span class="st"> </span>Population_FEntityWS <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb407-2"><a href="joins-y-set-operations.html#cb407-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">group_by</span>(Rango_edad) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb407-3"><a href="joins-y-set-operations.html#cb407-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise</span>(PoblaciónF =<span class="st"> </span><span class="kw">sum</span>(PoblaciónF), PoblaciónM =<span class="st"> </span><span class="kw">sum</span>(PoblaciónM))</span>
<span id="cb407-4"><a href="joins-y-set-operations.html#cb407-4" aria-hidden="true"></a></span>
<span id="cb407-5"><a href="joins-y-set-operations.html#cb407-5" aria-hidden="true"></a><span class="kw">full_join</span>(</span>
<span id="cb407-6"><a href="joins-y-set-operations.html#cb407-6" aria-hidden="true"></a>  Population_by_sex_age_Mexico  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(PoblaciónM)) <span class="op">%&gt;%</span></span>
<span id="cb407-7"><a href="joins-y-set-operations.html#cb407-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>PoblaciónF),</span>
<span id="cb407-8"><a href="joins-y-set-operations.html#cb407-8" aria-hidden="true"></a>  Population_by_sex_age_Mexico  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="kw">desc</span>(PoblaciónF)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb407-9"><a href="joins-y-set-operations.html#cb407-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>PoblaciónM), </span>
<span id="cb407-10"><a href="joins-y-set-operations.html#cb407-10" aria-hidden="true"></a>  <span class="dt">by =</span> <span class="st">&quot;Rango_edad&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 3
  Rango_edad PoblaciónM PoblaciónF
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt;
1 10 a 14      5881838.    5790366</code></pre>
<p>Finalmente, algunos puntos extra</p>
<ul>
<li>Recordando los cinco problemas en unos datos sin limpieza, dos que quedaron pendientes</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Múltiples tipos de observaciones están en la misma tabla.</li>
<li>Una sola observación esta en múltiples tablas.</li>
</ol>
<p>En el ejemplo que se ha tomado de la población mexicana tiene el primer defecto, ya que la población total bien podría quedar en una sola tabla junto con el nombre de la entidad y en otra los porcentajes de acuerdo a los rangos de edad. En general en este punto se debe tener en cuenta que cada unidad observacional debe tener su propia tabla, así logrando un técnica en bases de datos llamada normalización. Para este caso, se tendrían dos tablas</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="joins-y-set-operations.html#cb409-1" aria-hidden="true"></a>Population_FEntity &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_xls</span>(<span class="st">&quot;Data/Population_Sex_FEntity.xls&quot;</span>, <span class="dt">range =</span> <span class="st">&quot;B5:Q38&quot;</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>)</span>
<span id="cb409-2"><a href="joins-y-set-operations.html#cb409-2" aria-hidden="true"></a><span class="kw">colnames</span>(Population_FEntity)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Entidad Federativa&quot;</span>, <span class="st">&quot;Población Total&quot;</span>)</span>
<span id="cb409-3"><a href="joins-y-set-operations.html#cb409-3" aria-hidden="true"></a>Population_FEntity &lt;-<span class="st"> </span>Population_FEntity <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="dt">key =</span> <span class="st">&quot;Rango_edad&quot;</span>, </span>
<span id="cb409-4"><a href="joins-y-set-operations.html#cb409-4" aria-hidden="true"></a>           <span class="dt">value =</span> <span class="st">&quot;Porcentaje&quot;</span>, <span class="op">-</span><span class="kw">c</span>(<span class="st">&quot;Entidad Federativa&quot;</span>, <span class="st">&quot;Población Total&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb409-5"><a href="joins-y-set-operations.html#cb409-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Porcentaje =</span> Porcentaje<span class="op">/</span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb409-6"><a href="joins-y-set-operations.html#cb409-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">&quot;Población&quot;</span> =<span class="st"> </span>Porcentaje <span class="op">*</span><span class="st"> `</span><span class="dt">Población Total</span><span class="st">`</span>)</span>
<span id="cb409-7"><a href="joins-y-set-operations.html#cb409-7" aria-hidden="true"></a>(t1 &lt;-<span class="st"> </span>Population_FEntity <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Entidad Federativa</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Población Total</span><span class="st">`</span>))</span></code></pre></div>
<pre class="scroll-300"><code># A tibble: 462 x 2
   `Entidad Federativa` `Población Total`
   &lt;chr&gt;                            &lt;dbl&gt;
 1 República Mexicana           103498524
 2 Aguascalientes                 1066233
 3 Baja California                2856361
 4 Baja California Sur             512030
 5 Campeche                        755703
 6 Coahuila                       2501413
 7 Colima                          568642
 8 Chiapas                        4293414
 9 Chihuahua                      3241513
10 Distrito Federal               8737172
# … with 452 more rows</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="joins-y-set-operations.html#cb411-1" aria-hidden="true"></a>(t2 &lt;-<span class="st"> </span>Population_FEntity <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Entidad Federativa</span><span class="st">`</span>, Rango_edad,  Población))</span></code></pre></div>
<pre class="scroll-300"><code># A tibble: 462 x 3
   `Entidad Federativa` Rango_edad Población
   &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;
 1 República Mexicana   0 a 4       9637687 
 2 Aguascalientes       0 a 4        109853 
 3 Baja California      0 a 4        268842 
 4 Baja California Sur  0 a 4         46070 
 5 Campeche             0 a 4         63034.
 6 Coahuila             0 a 4        244624.
 7 Colima               0 a 4         45985 
 8 Chiapas              0 a 4        491525 
 9 Chihuahua            0 a 4        253834.
10 Distrito Federal     0 a 4        682914.
# … with 452 more rows</code></pre>
<p>Para el último punto se entiende que los datos están dispersos entre distintos conjuntos de datos, por lo que usar las funciones para combinar bases de datos ayudan en la resolución de este problema.</p>
<ul>
<li><p>Es recomendable estudiar el paquete <code>purrr</code>, el cual es parte del tidyverse y ofrece una versión ideal para trabajar con funciones anónimas en data frames, ya que al tratar de aplicar alguna función de la familia apply con un data frame estos son convertidos primero a una matriz lo cual hace perder muchos de sus atributos. Así, con las funciones de la “familia” <code>purrr::map</code> se pueden hacer todas las aplicaciones que se pueden hacer con alguna de la familia <code>apply</code> e incluso algunas más. Además de que tienen una aplicación ideal con <code>dplyr</code>. Véase <a href="https://dcl-prog.stanford.edu/purrr-mutate.html">Functional Programming</a>.</p></li>
<li><p>Se pueden usar las librerías <a href="https://dtplyr.tidyverse.org"><code>dtplyr</code></a>, <a href="https://dbplyr.tidyverse.org"><code>dbplyr</code></a> o <a href="https://spark.rstudio.com"><code>sparklyr</code></a> como interfaz para usar la sintaxis de <code>dplyr</code> en data.tables, bases de datos en SQL o en Apache Spark.</p></li>
<li><p>Recordar que la función <code>dplyr::near()</code> compara dos elementos numéricos en punto flotante.</p></li>
<li><p>La función <code>dplyr::case_when()</code> es una versión equivalente a <code>dplyr::if_else()</code> pero más general</p></li>
</ul>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="joins-y-set-operations.html#cb413-1" aria-hidden="true"></a><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">new_variable =</span> dplyr<span class="op">::</span><span class="kw">case_when</span>(x <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">~</span><span class="st"> &quot;Hola&quot;</span>, x <span class="op">==</span><span class="st"> </span><span class="dv">5</span> <span class="op">~</span><span class="st"> &quot;Adios&quot;</span>, <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span><span class="kw">as.character</span>(x)))</span></code></pre></div>
<pre><code># A tibble: 5 x 2
      x new_variable
  &lt;int&gt; &lt;chr&gt;       
1     1 Hola        
2     2 2           
3     3 3           
4     4 4           
5     5 Adios       </code></pre>
<ul>
<li><code>dplyr</code> proviene de la paquetería <code>plyr</code> la cual contiene muchas más funciones que pueden ser de utilidad en ciertas ocasiones.</li>
</ul>
<hr />
<div id="ejercicios" class="section level4 unnumbered">
<h4>Ejercicios</h4>
<ol start="79" style="list-style-type: decimal">
<li><p>Utiliza la función <code>dplyr::top_n()</code>.</p></li>
<li><p>En la siguiente <a href="https://regexone.com">página</a> se puede aprender sobre el uso de expresiones regulares. Usando las funciones <code>dplyr::select()</code> y <code>dplyr::matches()</code> replica los resultados que se dieron como ejemplo cuando se explico la función <code>dplyr::select()</code>.</p></li>
<li><p>Crea un data frame o tibble con 5 variables numéricas. Utiliza la función <code>dplyr::mutate_each()</code> para aplicar la función <code>dplyr::percent_rank()</code> en cada una de las variables.</p></li>
<li><p>Investigar algunas funciones de <code>purrr</code> como <code>reduce()</code>, <code>map()</code> y <code>accumulate()</code>.</p></li>
<li><p>Investiga el uso de <code>dplyr::semi_join()</code> y <code>dplyr::anti_join()</code>.</p></li>
<li><p>Si eres meticuloso, verás que algo anda en los datos de la población. ¿Por qué? Hint: Ve la tabla que se uso para los últimos ejemplos de la sección <code>dplyr</code>.</p></li>
<li><p>Obtén resultados necesarios para contestar las siguientes preguntas sobre la base de datos <code>population</code> que ofrece <code>dplyr</code>.</p></li>
</ol>
<ul>
<li>¿Cuantos años están registrados por país?</li>
<li>¿Qué países tienen mayor población por año?</li>
<li>¿Cuál es la edad promedio, con los años dados, de la población en cada país?</li>
<li>¿Qué países son aquellos que tienen más de un millón de habitantes en algún año?</li>
<li>¿Qué países tienen menos de un millón de habitantes en al menos un año?</li>
<li>¿Que país ha sido el que ha tenido la peor reducción en su población y en que año?</li>
<li>¿Qué país tuvo la mayor cantidad población en el año de tu nacimiento?</li>
<li>¿Cuál fue el año en que cada país tuvo su mayor numero de habitantes?</li>
<li>¿Cuál fue el año en que cada país tuvo su menor numero de habitantes?</li>
<li>¿Cuántos países considera la base de datos?</li>
</ul>
<ol start="86" style="list-style-type: decimal">
<li>La base de datos <code>who</code> de <code>dplyr</code> contiene la información sobre los reportes de tuberculosis en el mundo. Haz una limpieza en esta base utilizando las funciones de <code>tidyr</code> y obtén la siguiente información.</li>
</ol>
<ul>
<li>Por país ¿Cuál fue el año con mayor número de enfermos por tuberculosis?</li>
<li>Por país ¿Cuál de los tres diagnósticos diferentes tiene una mayor ocurrencia?</li>
<li>¿Cuál fue el año con mayor número de enfermos por país?</li>
<li>¿Qué país ha tenido el mayor número de enfermos por tuberculosis?</li>
<li>¿Cuál es el top-10 de países con mayor número de casos con tuberculosis?</li>
<li>¿Hay algún país sin casos de tuberculosis en los años registrados?</li>
<li>¿Cuál sexo es el más afectado, por país, con tuberculosis?</li>
<li>¿Cuál es el rango de edad con mayor número de casos con tuberculosis?</li>
<li>¿Cuál es el rango de edad con menor número de casos con tuberculosis?</li>
<li>Por rango de edad ¿Qué sexo es el más afectado con tuberculosis?</li>
</ul>
<ol start="87" style="list-style-type: decimal">
<li><p>Las bases de datos <code>who</code> y <code>population</code> están relacionadas, por lo que se pueden unir para responder lo siguiente: ¿Existen países en los que el año donde se tuvo el máximo número de enfermos por tuberculosis sean los años donde se obtuvo un gran descenso en la población?</p></li>
<li><p>La base de datos <code>storms</code> proporcionada por <code>dplyr</code> contiene la información acerca de 198 tormentas tropicales con diferentes atributos. Obtén la siguiente información.</p></li>
</ol>
<ul>
<li>¿Cuántos huracanes tuvieron las tres clasificaciones (Depresión Tropical, Tormenta Tropical y Huracán)?</li>
<li>¿Cuál año fue el que tuvo el mayor número de huracanes?</li>
<li>¿Cuál año fue el que tuvo el mayor número de Tormentas Tropicales?</li>
<li>¿Cuál es el mes con mayor actividad?</li>
<li>¿Qué tormenta ha sido la que tuvo mayor número de cambios en su categoría Saffir-Simpson?</li>
<li>¿Cuál ha sido la tormenta con mayor velocidad promedio del viento en nudos?</li>
<li>¿Por tormenta, cuál ha sido la velocidad máxima que alcanzo en <span class="math inline">\(k/h\)</span>?</li>
<li>Considerando que una tormenta se puede clasificar por el estatus que predomina en ella, ¿Qué tipo de tormenta es la más recurrente en el Atlántico?</li>
<li>¿Cuál ha sido la tormenta con mayor duración?</li>
<li>Considerando latitud y longitud en términos enteros (pensando así en segmentos del territorio), ¿Cuál ha sido la ubicación donde se ha tenido la mayor cantidad de tormentas?</li>
</ul>
<ol start="89" style="list-style-type: decimal">
<li>Utiliza las funciones Join que proporciona <code>dplyr</code> con las bases de datos <code>dplyr::band_instruments</code> y <code>dplyr::and_members</code>.</li>
</ol>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="dplyrrename.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graficación-de-datos-ggplot.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "github", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
